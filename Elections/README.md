# Elections
Имитация подсчета результатов голосования
 
# Запуск

* make clean - сброс системы к начальному состоянию
* make run - запуск системы


# Описание 
В качестве образца данных использованы результаты президентских выборов РФ в 2018г: 
https://github.com/Gralph2k/data-engineer/blob/master/Elections/notebooks/voting_data_eng.csv

Скрипт разбивающий исходный файл на файлы, пришедшие от региональных избирательных коммитетов: https://github.com/Gralph2k/data-engineer/blob/master/Elections/notebooks/ExplodeData.ipynb

Исходные данные в csv формате должны находиться в ./Data/Source

Сервис Producer отвечает за чтение данных, предоставленных избирательными комиссиями и отправку из в Kafka. 
1. последовательно читает файлы
2. построчно проверяет формат данных
3. валидные строки сериализуются в json, посылаются в Kafka и логируются в ./Data/SuccessRows
4. невалидные строки логируются в ./Data/ErrorRows с указанием ошибки
5. обработанные файлы перекладываются в ./Data/Processed

Consumer отвечает перекачку данных из Kafka в Postgres
1. читает данные из Kafka
2. десериализует записи и пишет их в Postgres в таблицу <НазваниеВыборов>_Source

Analyser агрегирует данные, проверяет их валидность и выводит результат.
1. Находит последние пришедшие данные от избирательного участка, реализую таким образом семантику exactly-once
2. Сохраняет очищенные данные в в таблицу <НазваниеВыборов>_Clean
3. Агрегирует данные
4. Валидирует агрегированные данные по списку правил. Например, сумма голосов за кандидатов не может превышать количество бюллетеней
5. Выводит текущие результаты выборов
